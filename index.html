<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Interactive Portfolio</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Three.js Import Map -->
    <script type="importmap">
    {
      "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.module.js",
        "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.158.0/examples/jsm/"
      }
    }
    </script>

    <!-- Inline CSS -->
    <style>
        :root {
            --bg-color: #000000;
            --primary-color: #ffffff;
            --font-family: 'Inter', sans-serif;
            --panel-bg-color: rgba(14, 14, 14, 0.6);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: var(--font-family);
            background-color: var(--bg-color);
            color: var(--primary-color);
        }

        #main-canvas, #welcome-canvas {
            cursor: pointer;
        }

        /* --- Transition Overlay --- */
        #transition-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-color);
            opacity: 0;
            pointer-events: none;
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            transition: opacity 1.5s ease;
        }

        #transition-overlay.active {
            opacity: 1;
            pointer-events: all;
        }


        /* --- Welcome Screen --- */
        #welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-color);
            z-index: 1000;
            opacity: 1;
            transition: opacity 1.5s ease-in-out, visibility 1.5s;
            visibility: visible;
            cursor: pointer;
        }

        #welcome-screen.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        #welcome-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .welcome-overlay {
            position: relative;
            z-index: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.2);
            text-align: center;
        }

        .welcome-content {
            animation: fadeIn 2s ease-in-out;
        }
        
        #welcome-title {
            font-size: 3rem;
            font-weight: 700;
            letter-spacing: 2px;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        #welcome-subtitle {
            font-size: 1rem;
            font-weight: 400;
            color: rgba(255, 255, 255, 0.8);
            letter-spacing: 4px;
            text-transform: uppercase;
        }
        
        #enter-prompt {
            margin-top: 2.5rem;
            padding: 14px 32px;
            font-size: 1rem;
            font-weight: 500;
            color: var(--bg-color);
            background-color: var(--primary-color);
            border: none;
            border-radius: 30px;
            cursor: pointer;
            letter-spacing: 1px;
            text-transform: uppercase;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.2);
        }

        #enter-prompt:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.3);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* --- Split-Screen Layout & Animations --- */
        #main-content {
            opacity: 0;
            transition: opacity 1.5s ease-in-out;
            width: 100vw;
            height: 100vh;
            position: relative;
        }

        #main-content.animate-in { opacity: 1; }
        
        .split-layout { display: flex; width: 100%; height: 100%; }

        .left-panel {
            width: 50%;
            height: 100%;
            padding: 40px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            transition: filter 0.5s ease;
        }
        
        .left-panel::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 1px;
            height: 100%;
            background-color: var(--primary-color);
            transform: scaleY(0);
            transform-origin: center;
            transition: transform 1s cubic-bezier(0.19, 1, 0.22, 1) 0.4s;
        }

        #main-content.animate-in .left-panel::after { transform: scaleY(1); }

        .header-logo {
            position: absolute;
            top: 40px;
            left: 40px;
            font-weight: 700;
            font-size: 1.5rem;
        }

        .center-content-container { display: flex; flex-direction: column; align-items: center; gap: 2rem; }
        .center-content { text-align: center; display: flex; flex-direction: column; align-items: center; }
        
        .slide-content-wrapper {
            padding: 0;
            border-radius: 12px;
            transition: padding 0.4s ease, background-color 0.4s ease, border 0.4s ease, backdrop-filter 0.4s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .left-panel.has-backdrop .slide-content-wrapper {
            padding: 1.5rem 2rem;
            background-color: rgba(20, 20, 20, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
        }

        .main-logo { width: 100px; height: 100px; margin-bottom: 2rem; }
        .brand-name { font-size: 2.5rem; font-weight: 700; margin-bottom: 0.5rem; }
        .tagline { font-size: 1rem; font-weight: 400; color: rgba(255, 255, 255, 0.7); }
        
        .details-explore-btn {
            display: none; /* Hidden by default */
            margin-top: 2rem;
            padding: 12px 24px;
            border: 1px solid var(--primary-color);
            background: transparent;
            color: var(--primary-color);
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        .details-explore-btn:hover { background-color: var(--primary-color); color: var(--bg-color); }
        
        .slider-nav { display: flex; align-items: center; gap: 20px; margin-top: 2.5rem; }
        
        .nav-arrow {
            background: transparent;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s, color 0.3s;
            font-size: 1.5rem;
            width: 100px;
            height: 40px;
            border-radius: 20px;
        }
        .nav-arrow:hover { background-color: var(--primary-color); color: var(--bg-color); }
        
        .dots { display: flex; gap: 10px; }
        .dot { width: 8px; height: 8px; background-color: rgba(255, 255, 255, 0.4); border-radius: 50%; transition: background-color 0.3s; }
        .dot.active { background-color: var(--primary-color); }

        .right-panel {
            width: 50%;
            height: 100%;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        #texture-toggle-btn {
            position: absolute;
            top: 40px;
            right: 100px;
            z-index: 101;
            width: 50px;
            height: 50px;
            border: 1px solid var(--primary-color);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            background: transparent;
            color: var(--primary-color);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }
        #texture-toggle-btn.visible {
            opacity: 1;
            pointer-events: all;
        }
        #texture-toggle-btn:hover { background-color: rgba(255, 255, 255, 0.1); }
        
        #info-toggle-btn {
            position: absolute;
            top: 40px;
            right: 40px;
            z-index: 101;
            transition: opacity 0.3s, transform 0.3s;
            width: 50px;
            height: 50px;
            border: 1px solid var(--primary-color);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #info-toggle-btn:hover { background-color: rgba(255, 255, 255, 0.1); }
        #info-toggle-btn svg { stroke: var(--primary-color); }
        
        #mobile-back-btn { display: none; }

        .scroll-indicator {
            position: absolute;
            top: 50%;
            left: -8px;
            transform: translateY(-50%);
            width: 16px;
            height: 32px;
            background-color: var(--bg-color);
            border: 1px solid var(--primary-color);
            border-radius: 8px;
        }
        
        #canvas-container {
            width: 100%;
            height: 100%;
            position: absolute;
            transition: filter 0.5s ease;
        }
        #main-canvas { width: 100%; height: 100%; display: block; }
        
        #info-panel {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--panel-bg-color);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            z-index: 110;
            transform: translateX(100%);
            opacity: 0;
            pointer-events: none;
            transition: transform 0.5s cubic-bezier(0.77, 0, 0.175, 1), opacity 0.5s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 80px 40px 40px;
            overflow-y: auto;
        }

        #info-panel.active {
            transform: translateX(0);
            opacity: 1;
            pointer-events: all;
        }

        #info-panel-close-btn {
            position: absolute;
            top: 40px;
            right: 40px;
            width: 50px;
            height: 50px;
            border: 1px solid var(--primary-color);
            border-radius: 50%;
            cursor: pointer;
            background: transparent;
        }
         #info-panel-close-btn span {
            position: absolute;
            width: 20px;
            height: 1px;
            background-color: var(--primary-color);
            top: 50%;
            left: 50%;
        }
        #info-panel-close-btn span:first-child { transform: translate(-50%, -50%) rotate(45deg); }
        #info-panel-close-btn span:last-child { transform: translate(-50%, -50%) rotate(-45deg); }

        .info-logo { max-width: 150px; margin-bottom: 2rem; }
        .info-divider { width: 80%; height: 1px; background-color: rgba(255, 255, 255, 0.2); margin: 1.5rem 0; }
        .info-description { text-align: center; max-width: 400px; line-height: 1.6; }
        
        .info-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }

        .info-icon-group { display: flex; gap: 20px; }
        .info-icon-group a { color: var(--primary-color); transition: color 0.3s, transform 0.3s; }
        .info-icon-group a:hover { transform: scale(1.1); color: #aaa; }
        .info-icon-group svg { width: 32px; height: 32px; }

        /* --- Mobile Specific Styles --- */
        @media (max-width: 768px) {
            .split-layout { position: relative; overflow: hidden; }
            .left-panel {
                width: 100%;
                height: 100%;
                z-index: 10;
                flex-direction: column;
                justify-content: center;
                padding: 40px;
            }
            .left-panel::after, .header-logo, .scroll-indicator {
                display: none;
            }
            
            .details-explore-btn { display: block; }
            
            .right-panel {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                transform: translateX(100%);
                z-index: 20;
                opacity: 0;
                pointer-events: none;
                transition: transform 0.6s cubic-bezier(0.77, 0, 0.175, 1), opacity 0.6s ease;
            }

            body.mobile-details-active .right-panel {
                transform: translateX(0);
                opacity: 1;
                pointer-events: all;
            }

            body.mobile-details-active .left-panel { filter: blur(5px); pointer-events: none; }
            
            #mobile-back-btn {
                    display: flex !important;
                    align-items: center;
                    justify-content: center;
                    position: absolute !important;
                    bottom: 50px !important;
                    left: 25px !important;
                    z-index: 105;
                    width: 50px;
                    height: 50px;
                    border: 1px solid var(--primary-color);
                    border-radius: 50%;
                    background: transparent;
                    color: var(--primary-color);
                    font-size: 1.5rem;
                    cursor: pointer;
                }
            
            #texture-toggle-btn {
                bottom: 50px !important;
                right: 25px !important;
                top: auto !important;
                left: auto !important;
            }
            
            #info-panel { position: fixed; }
             /* Tombol Info di tengah bawah */
            #info-toggle-btn {
                position: absolute !important;
                bottom: 85px !important;
                left: 50% !important;
                transform: translateX(-50%) !important;
                right: auto !important;
                top: auto !important;
                z-index: 103;
                width: 50px;
                height: 50px;
                border: 1px solid var(--primary-color);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                background: transparent;
            }
        }
    </style>
</head>
<body>

    <div id="transition-overlay">Now Loading...</div>

    <div id="welcome-screen">
        <canvas id="welcome-canvas"></canvas>
        <div class="welcome-overlay">
            <div class="welcome-content">
                <h1 id="welcome-title">WELCOME</h1>
                <p id="welcome-subtitle">GLAD YOU'RE HERE</p>
                <button id="enter-prompt">Start Here</button>
            </div>
        </div>
    </div>
    
    <main id="main-content">
        <div class="split-layout">
            <div class="left-panel">
                <div class="header-logo">MRN</div>
                <div class="center-content-container">
                    <div class="center-content">
                        <div class="slide-content-wrapper">
                            <svg class="main-logo" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                <path d="M 20 80 L 20 20 L 50 50 L 80 20 L 80 80" stroke="white" stroke-width="8" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <h1 class="brand-name">MRN</h1>
                            <p class="tagline">Design Studio</p>
                        </div>
                        <button class="details-explore-btn">View Details</button>
                    </div>
                    <div class="slider-nav">
                        <button class="nav-arrow prev">&lt;</button>
                        <div class="dots">
                            <span class="dot active"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span>
                        </div>
                        <button class="nav-arrow next">&gt;</button>
                    </div>
                </div>
            </div>

            <div class="right-panel">
                <button id="mobile-back-btn">&lt;</button>
                <button id="texture-toggle-btn">
                     <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                        <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                        <line x1="12" y1="22.08" x2="12" y2="12"></line>
                    </svg>
                </button>
                <div id="info-toggle-btn">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                </div>
                
                <div id="canvas-container">
                     <canvas id="main-canvas"></canvas>
                </div>

                <div id="info-panel">
                    <button id="info-panel-close-btn">
                        <span></span>
                        <span></span>
                    </button>
                    <img src="" alt="Brand Logo" class="info-logo">
                    <div class="info-divider"></div>
                    <p class="info-description"></p>
                    <div class="info-divider"></div>
                    <div class="info-section">
                        <div class="info-icon-group" id="social-icons"></div>
                    </div>
                    <div style="margin-top: auto;"></div> <!-- Spacer -->
                    <div class="info-section">
                        <div class="info-icon-group" id="ecommerce-icons"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Inline JavaScript -->
    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';

        let mainScene, mainCamera, mainRenderer, mainControls, mainObject;
        let welcomeScene, welcomeCamera, welcomeRenderer, galaxy, welcomeObjects = [];
        let mainGalaxy, mainWelcomeObjects = [];
        
        let socialIcons, devIcons, raycaster, mouse;
        const clock = new THREE.Clock();
        const gltfLoader = new GLTFLoader();
        let currentSlideIndex = 0;
        let isAnimating = false;
        let isWelcomeSceneActive = true;
        
        // --- Model Configuration ---
        const objectModels = {
            padvyModel: { type: 'glb', path: './padvy3d.glb' },
            clothmodel: { type: 'glb', path: './clothmodel.glb' },
            mrn: { type: 'glb', path: './mrn.glb' },
            search: { type: 'glb', path: './search.glb' },

        };
        
        const welcomeScreenModels = [
            { id: 'obj1', type: 'Octahedron', args: [1.2, 0], position: new THREE.Vector3(-3, 0.5, 0) },
            { id: 'obj2', type: 'Dodecahedron', args: [1.4, 0], position: new THREE.Vector3(3, -0.5, -1) },
            { id: 'obj3', type: 'Cone', args: [0.6, 1.2, 8], position: new THREE.Vector3(0.5, 3, -2) },
            { id: 'obj4', type: 'Cylinder', args: [0.5, 0.5, 1, 16], position: new THREE.Vector3(-1, -3, -1.5) },
        ];

        let isWireframeMode = false;
        let originalMaterials = new Map();
        const wireframeMaterial = new THREE.MeshStandardMaterial({ color: 0xffffff, wireframe: true });

        const slidesData = [
            { 
                name: 'MRN', tagline: 'Design Studio', objectType: 'mrn', showLogo: true, iconSet: 'social', hasBackdrop: false,
                info: {
                    logo: 'https://placehold.co/400x150/0e0e0e/ffffff?text=MRN+Logo',
                    description: 'Sebagai layanan manajemen utama, MRN Studio bertugas mengembangkan serta mengoptimalkan kedua brand yang ada demi mencapai sistem pengelolaan yang lebih baik dan berkelanjutan.',
                    ecommerce: ['shopee', 'tokopedia'],
                    social: ['linkedin', 'instagram']
                }
            },
            { 
                name: 'INVONITE', tagline: 'BRAND IDENTITY', objectType: 'search', showLogo: false, iconSet: 'social', hasBackdrop: true,
                info: {
                    logo: 'https://placehold.co/400x150/0e0e0e/ffffff?text=INVONITE',
                    description: 'INVONITE, penyedia layanan profesional dalam pengembangan dan inovasi digital interaktif berkualitas.',
                    ecommerce: ['shopee'],
                    social: ['youtube', 'twitter', 'facebook']
                }
            },
            { 
                name: 'PADVY', tagline: 'BRAND IDENTITY', objectType: 'padvyModel', showLogo: false, iconSet: 'development', hasBackdrop: true,
                 info: {
                    logo: 'https://placehold.co/400x150/0e0e0e/ffffff?text=PADVY',
                    description: 'PADVY, menghadirkan identitas gaya melalui produk kreatif berkualitas.',
                    ecommerce: [],
                    social: ['github']
                }
            },
            { 
                name: 'EXPLORE', tagline: 'EXPLORE MODE', objectType: 'search', showLogo: false, iconSet: null, hasBackdrop: false,
                info: null
            }
        ];
        
        const svgIcons = {
            linkedin: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>`,
            instagram: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg>`,
            youtube: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>`,
            twitter: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>`,
            facebook: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>`,
            github: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>`,
            shopee: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3.5 4.5 L3.5 5.5 C3.5 8.5 6 10.5 9 10.5 L15 10.5 C18 10.5 20.5 8.5 20.5 5.5 L20.5 4.5 M12 10.5 L12 20.5 M8.5 20.5 L15.5 20.5 M6.5 14.5 L17.5 14.5"></path><path d="M14.5 5.5 C14.5 6.9 13.4 8 12 8 C10.6 8 9.5 6.9 9.5 5.5 C9.5 4.1 10.6 3 12 3 C13.4 3 14.5 4.1 14.5 5.5z"></path></svg>`,
            tokopedia: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3.5 8.5 L12 3.5 L20.5 8.5 L20.5 15.5 L12 20.5 L3.5 15.5 Z"></path><path d="M8.5 12 L15.5 12 L12 15.5 Z"></path><path d="M12 3.5 L12 8.5"></path></svg>`,
        };
        
        const iconData = {
            social: [
                { icon: 'https://img.icons8.com/ios-filled/50/ffffff/instagram-new.png', url: 'https://instagram.com' },
                { icon: 'https://img.icons8.com/ios-filled/50/ffffff/twitterx.png', url: 'https://twitter.com' },
                { icon: 'https://img.icons8.com/ios-filled/50/ffffff/youtube-play.png', url: 'https://youtube.com' },
                { icon: 'https://img.icons8.com/ios-filled/50/ffffff/linkedin.png', url: 'https://linkedin.com' },
            ],
            development: [
                 { icon: 'https://img.icons8.com/ios-filled/50/ffffff/github.png', url: 'https://github.com' },
                 { icon: 'https://img.icons8.com/ios-filled/50/ffffff/codepen.png', url: 'https://codepen.io' },
                 { icon: 'https://img.icons8.com/ios-filled/50/ffffff/stackoverflow.png', url: 'https://stackoverflow.com' },
                 { icon: 'https://img.icons8.com/ios-filled/50/ffffff/figma.png', url: 'https://figma.com' },
            ]
        };

        const body = document.body;
        const welcomeScreen = document.getElementById('welcome-screen');
        const infoToggleBtn = document.getElementById('info-toggle-btn');
        const textureToggleBtn = document.getElementById('texture-toggle-btn');
        const mainCanvas = document.getElementById('main-canvas');
        const canvasContainer = document.getElementById('canvas-container');
        const prevButtons = document.querySelectorAll('.nav-arrow.prev');
        const nextButtons = document.querySelectorAll('.nav-arrow.next');
        const dots = document.querySelectorAll('.dots .dot');
        const centerContent = document.querySelector('.center-content');
        const brandNameEl = document.querySelector('.brand-name');
        const taglineEl = document.querySelector('.tagline');
        const mainLogoEl = document.querySelector('.main-logo');
        const detailsExploreBtn = document.querySelector('.details-explore-btn');
        const leftPanel = document.querySelector('.left-panel');
        const transitionOverlay = document.getElementById('transition-overlay');
        const infoPanel = document.getElementById('info-panel');
        const infoPanelCloseBtn = document.getElementById('info-panel-close-btn');
        const mobileBackBtn = document.getElementById('mobile-back-btn');
        const infoLogo = document.querySelector('.info-logo');
        const infoDescription = document.querySelector('.info-description');
        const ecommerceIconsContainer = document.getElementById('ecommerce-icons');
        const socialIconsContainer = document.getElementById('social-icons');
        
        function startExploreTransition() {
            transitionOverlay.classList.add('active');
            setTimeout(() => { window.location.href = '3dweb.html'; }, 2500);
        }

        function initUI() {
            welcomeScreen.addEventListener('click', () => {
                welcomeScreen.classList.add('hidden');
                setTimeout(() => {
                    isWelcomeSceneActive = false;
                    document.getElementById('main-content').classList.add('animate-in');
                    textureToggleBtn.classList.add('visible');
                }, 1500);
            }, { once: true });

            infoToggleBtn.addEventListener('click', () => {
                infoPanel.classList.add('active');
                canvasContainer.style.filter = 'blur(5px)';
            });
            
            infoPanelCloseBtn.addEventListener('click', () => {
                 infoPanel.classList.remove('active');
                 canvasContainer.style.filter = 'none';
            });
            
            textureToggleBtn.addEventListener('click', () => {
                isWireframeMode = !isWireframeMode;
                const objectToUpdate = mainObject; // Only affects main scene object now
                if (objectToUpdate) {
                    objectToUpdate.traverse((child) => {
                        if (child.isMesh) {
                            if (isWireframeMode) {
                                child.material = wireframeMaterial;
                            } else {
                                child.material = originalMaterials.get(child.uuid) || child.material;
                            }
                        }
                    });
                }
            });

            detailsExploreBtn.addEventListener('click', () => {
                if (currentSlideIndex === 3) {
                    startExploreTransition();
                } else {
                     if (window.innerWidth <= 768) {
                        body.classList.add('mobile-details-active');
                    }
                }
            });
            
            mobileBackBtn.addEventListener('click', () => { body.classList.remove('mobile-details-active'); });
            prevButtons.forEach(btn => btn.addEventListener('click', () => navigateSlide(-1)));
            nextButtons.forEach(btn => btn.addEventListener('click', () => navigateSlide(1)));
            mainCanvas.addEventListener('click', onCanvasClick);
            window.addEventListener('resize', onResize);
        }

        function navigateSlide(direction) {
            if (isAnimating) return;
            const newIndex = (currentSlideIndex + direction + slidesData.length) % slidesData.length;
            updateSlide(newIndex);
        }
        
        function updateInfoPanel(slideData) {
            if (!slideData.info) {
                infoPanel.classList.remove('active');
                canvasContainer.style.filter = 'none';
                infoLogo.src = '';
                infoDescription.textContent = '';
                ecommerceIconsContainer.innerHTML = '';
                socialIconsContainer.innerHTML = '';
                document.querySelectorAll('.info-section, .info-divider').forEach(el => el.style.display = 'none');
                return;
            }

            infoLogo.src = slideData.info.logo;
            infoDescription.textContent = slideData.info.description;

            const createIcons = (container, iconNames) => {
                container.innerHTML = '';
                const parentSection = container.closest('.info-section');
                
                if (!iconNames || iconNames.length === 0) {
                    if (parentSection) parentSection.style.display = 'none';
                    const divider = parentSection ? parentSection.previousElementSibling : null;
                    if (divider && divider.classList.contains('info-divider')) divider.style.display = 'none';
                } else {
                    if (parentSection) parentSection.style.display = 'flex';
                    const divider = parentSection ? parentSection.previousElementSibling : null;
                    if (divider && divider.classList.contains('info-divider')) divider.style.display = 'block';
                    iconNames.forEach(name => {
                        const link = document.createElement('a');
                        link.href = '#';
                        link.target = '_blank';
                        link.innerHTML = svgIcons[name] || '';
                        container.appendChild(link);
                    });
                }
            };
            createIcons(ecommerceIconsContainer, slideData.info.ecommerce);
            createIcons(socialIconsContainer, slideData.info.social);
        }

        function updateSlide(newIndex) {
            const isInitialCall = newIndex === currentSlideIndex && !isAnimating;
            if (newIndex === currentSlideIndex && !isInitialCall) return;
            if(!isInitialCall) isAnimating = true;
            centerContent.classList.add('is-changing');
            if (socialIcons) socialIcons.visible = false;
            if (devIcons) devIcons.visible = false;
            
            setTimeout(() => {
                const slide = slidesData[newIndex];
                brandNameEl.textContent = slide.name;
                taglineEl.textContent = slide.tagline;
                mainLogoEl.style.display = slide.showLogo ? 'block' : 'none';
                leftPanel.classList.toggle('has-backdrop', slide.hasBackdrop);

                if (newIndex === 3) {
                    detailsExploreBtn.textContent = 'Start Explore';
                    detailsExploreBtn.style.display = 'block';
                    infoToggleBtn.style.opacity = '0';
                    infoToggleBtn.style.pointerEvents = 'none';
                } else {
                    detailsExploreBtn.textContent = 'View Details';
                    detailsExploreBtn.style.display = window.innerWidth > 768 ? 'none' : 'block';
                    infoToggleBtn.style.opacity = '1';
                    infoToggleBtn.style.pointerEvents = 'all';
                }

                if (slide.iconSet === 'social' && socialIcons) {
                    socialIcons.visible = true;
                    socialIcons.children.forEach(icon => icon.scale.set(0, 0, 0));
                }
                if (slide.iconSet === 'development' && devIcons) {
                    devIcons.visible = true;
                    devIcons.children.forEach(icon => icon.scale.set(0, 0, 0));
                }

                update3DObject(mainScene, slide.objectType, (obj) => { mainObject = obj; });
                updateInfoPanel(slide);
                dots.forEach((dot, index) => dot.classList.toggle('active', index === newIndex));
                currentSlideIndex = newIndex;
                centerContent.classList.remove('is-changing');
                if(!isInitialCall) isAnimating = false;
            }, isInitialCall ? 0 : 400); 
        }

        function createIconGroup(icons) {
            const group = new THREE.Group();
            const textureLoader = new THREE.TextureLoader();
            const geometry = new THREE.PlaneGeometry(0.5, 0.5);
            icons.forEach((data, i) => {
                textureLoader.load(data.icon, (texture) => {
                    const material = new THREE.MeshBasicMaterial({ map: texture, transparent: true, alphaTest: 0.5 });
                    const iconMesh = new THREE.Mesh(geometry, material);
                    const angle = (i / icons.length) * Math.PI * 2;
                    const radius = 2.4;
                    iconMesh.position.set(Math.cos(angle) * radius, (Math.random() - 0.5) * 2, Math.sin(angle) * radius);
                    iconMesh.userData = {
                        url: data.url,
                        initialPosition: iconMesh.position.clone(),
                        noise: { x: Math.random() * 6.28, y: Math.random() * 6.28, z: Math.random() * 6.28, speed: 0.3 + Math.random() * 0.4 }
                    };
                    group.add(iconMesh);
                });
            });
            group.visible = false;
            return group;
        }

        function initIcons() {
            raycaster = new THREE.Raycaster();
            mouse = new THREE.Vector2();
            
            socialIcons = createIconGroup(iconData.social);
            mainScene.add(socialIcons);

            devIcons = createIconGroup(iconData.development);
            mainScene.add(devIcons);
        }
        
        function onCanvasClick(event) {
            if (infoPanel.classList.contains('active')) return;
            const currentIconSet = slidesData[currentSlideIndex].iconSet;
            if (!currentIconSet) return;
            const rect = mainCanvas.getBoundingClientRect();
            mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
            mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
            raycaster.setFromCamera(mouse, mainCamera);
            const groupToCheck = currentIconSet === 'social' ? socialIcons : devIcons;
            const intersects = raycaster.intersectObjects(groupToCheck.children);
            if (intersects.length > 0 && intersects[0].object.userData.url) {
                window.open(intersects[0].object.userData.url, '_blank');
            }
        }
        
        function createGeometry(type, args = []) {
             const GeometryClass = THREE[type + 'Geometry'];
            if (GeometryClass) {
                return new GeometryClass(...args);
            }
            console.warn(`Geometry type "${type}" not found, falling back to Icosahedron.`);
            return new THREE.IcosahedronGeometry(1.8, 0); 
        }

        function update3DObject(scene, modelKey, callback) {
            let currentObject = mainObject;
            if (currentObject) scene.remove(currentObject);
            
            const modelConfig = objectModels[modelKey];

            if (modelConfig && modelConfig.type === 'glb') {
                gltfLoader.load(modelConfig.path, 
                    (gltf) => {
                        currentObject = gltf.scene;
                        originalMaterials.clear();
                        currentObject.traverse((child) => {
                            if (child.isMesh) {
                                originalMaterials.set(child.uuid, child.material);
                            }
                        });
                        if (isWireframeMode) {
                            currentObject.traverse((child) => { if (child.isMesh) child.material = wireframeMaterial; });
                        }
                        currentObject.scale.set(0, 0, 0);
                        scene.add(currentObject);
                        callback(currentObject);
                    }, 
                    undefined, 
                    (error) => {
                        console.error(`Error loading GLB model: ${modelKey}`, error);
                        const fallbackGeo = createGeometry('Box', [2, 2, 2]);
                        currentObject = new THREE.Mesh(fallbackGeo, wireframeMaterial);
                        scene.add(currentObject);
                        callback(currentObject);
                    }
                );
            } else {
                 console.error(`Model key "${modelKey}" not found in objectModels.`);
                 const fallbackGeo = createGeometry('Icosahedron');
                 currentObject = new THREE.Mesh(fallbackGeo, wireframeMaterial);
                 scene.add(currentObject);
                 callback(currentObject);
            }
        }
        
        function createGalaxy() {
            const galaxyGroup = new THREE.Group();
            
            // Star particles
            const starCount = 2000;
            const positions = new Float32Array(starCount * 3);
            const starGeometry = new THREE.BufferGeometry();
            for (let i = 0; i < starCount; i++) {
                const i3 = i * 3;
                positions[i3] = (Math.random() - 0.5) * 15;
                positions[i3 + 1] = (Math.random() - 0.5) * 15;
                positions[i3 + 2] = (Math.random() - 0.5) * 15;
            }
            starGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            const starMaterial = new THREE.PointsMaterial({
                size: 0.02,
                color: 0xffffff,
                transparent: true,
                blending: THREE.AdditiveBlending,
                depthWrite: false,
            });
            const starParticles = new THREE.Points(starGeometry, starMaterial);
            galaxyGroup.add(starParticles);

            // Constellation lines
            const constellationPoints = [];
            const constellationPointCount = 150;
            for (let i = 0; i < constellationPointCount; i++) {
                 const x = (Math.random() - 0.5) * 10;
                 const y = (Math.random() - 0.5) * 10;
                 const z = (Math.random() - 0.5) * 10;
                 constellationPoints.push(new THREE.Vector3(x, y, z));
            }

            const lineVertices = [];
            const connectionThreshold = 1.5;
            for (let i = 0; i < constellationPointCount; i++) {
                for (let j = i + 1; j < constellationPointCount; j++) {
                    if (constellationPoints[i].distanceTo(constellationPoints[j]) < connectionThreshold) {
                        lineVertices.push(constellationPoints[i].x, constellationPoints[i].y, constellationPoints[i].z);
                        lineVertices.push(constellationPoints[j].x, constellationPoints[j].y, constellationPoints[j].z);
                    }
                }
            }
            const lineGeometry = new THREE.BufferGeometry();
            lineGeometry.setAttribute('position', new THREE.Float32BufferAttribute(lineVertices, 3));
            const lineMaterial = new THREE.LineBasicMaterial({ color: 0xffffff, transparent: true, opacity: 0.2 });
            const constellationLines = new THREE.LineSegments(lineGeometry, lineMaterial);
            galaxyGroup.add(constellationLines);
            
            return galaxyGroup;
        }

        function createWelcomeObjects(scene, scale = 1) {
            const material = new THREE.MeshBasicMaterial({ color: 0xffffff, wireframe: true });
            const createdObjects = [];
            
            welcomeScreenModels.forEach(config => {
                let obj;
                if (config.type === 'glb') {
                    // GLB loading logic for welcome screen (if needed in future)
                    gltfLoader.load(config.path, (gltf) => {
                        obj = gltf.scene;
                        obj.traverse(child => { if(child.isMesh) child.material = material; });
                        obj.position.copy(config.position).multiplyScalar(scale);
                        scene.add(obj);
                        createdObjects.push(obj);
                    });
                } else {
                    const geo = createGeometry(config.type, config.args);
                    obj = new THREE.Mesh(geo, material);
                    obj.position.copy(config.position).multiplyScalar(scale);
                    scene.add(obj);
                    createdObjects.push(obj);
                }
            });
            return createdObjects;
        }

        function initWelcomeScene() {
            const canvas = document.getElementById('welcome-canvas');
            welcomeScene = new THREE.Scene();
            welcomeCamera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            welcomeCamera.position.z = 6;
            welcomeRenderer = new THREE.WebGLRenderer({ canvas, antialias: true, alpha: true });
            welcomeRenderer.setSize(window.innerWidth, window.innerHeight);
            welcomeRenderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            
            welcomeScene.add(new THREE.AmbientLight(0xffffff, 0.3));
            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(5, 5, 5);
            welcomeScene.add(directionalLight);
            
            galaxy = createGalaxy();
            welcomeScene.add(galaxy);
            welcomeObjects = createWelcomeObjects(welcomeScene);
        }

        function initMainScene() {
            mainScene = new THREE.Scene();
            const container = document.getElementById('canvas-container');
            if (!container) return;
            mainCamera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
            mainCamera.position.z = 4.5;
            mainRenderer = new THREE.WebGLRenderer({ canvas: mainCanvas, antialias: true, alpha: true });
            mainRenderer.setSize(container.clientWidth, container.clientHeight);
            mainRenderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            mainControls = new OrbitControls(mainCamera, mainRenderer.domElement);
            Object.assign(mainControls, { enableDamping: true, enableZoom: false, enablePan: false, autoRotate: true, autoRotateSpeed: 0.5 });
            mainScene.add(new THREE.AmbientLight(0xffffff, 0.7));
            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(5, 5, 5);
            mainScene.add(directionalLight);
            
            // Add background elements to main scene
            mainGalaxy = createGalaxy();
            mainScene.add(mainGalaxy);
            mainWelcomeObjects = createWelcomeObjects(mainScene, 1.8); // Create same objects but scaled up

            updateSlide(0); 
        }

        function onResize() {
            // Welcome scene
            welcomeCamera.aspect = window.innerWidth / window.innerHeight;
            welcomeCamera.updateProjectionMatrix();
            welcomeRenderer.setSize(window.innerWidth, window.innerHeight);
            welcomeRenderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

            // Main scene
            const isMobile = window.innerWidth <= 768;
            const container = document.getElementById('canvas-container');
            if (!container || !mainCamera || !mainRenderer) return;
            const { clientWidth: width, clientHeight: height } = isMobile ? document.body : container;
            mainCamera.aspect = width / height;
            mainCamera.updateProjectionMatrix();
            mainRenderer.setSize(width, height);
            mainRenderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            updateSlide(currentSlideIndex);
        }
        
        function animateIcons(group, camera, elapsedTime) {
             if (group && group.visible) {
                group.children.forEach(icon => {
                    if (icon.scale.x < 1) {
                        const scale = Math.min(icon.scale.x + 0.08, 1);
                        icon.scale.set(scale, scale, scale);
                    }
                    const { initialPosition: pos, noise } = icon.userData;
                    if (!pos || !noise) return;
                    const time = elapsedTime * noise.speed;
                    icon.position.set(pos.x + Math.sin(time + noise.x) * 0.2, pos.y + Math.cos(time + noise.y) * 0.2, pos.z + Math.sin(time + noise.z) * 0.2);
                    icon.lookAt(camera.position);
                });
            }
        }
        
        function animateWelcomeObjects(objects, elapsedTime) {
            objects.forEach((obj, i) => {
                if (obj) {
                    const config = welcomeScreenModels[i];
                    obj.rotation.x += 0.002 * (i % 2 === 0 ? 1 : -1);
                    obj.rotation.y += 0.002 * (i % 2 === 0 ? 1 : -1);
                    obj.position.y = config.position.y + Math.sin(elapsedTime * (0.7 + i * 0.1)) * 0.2;
                }
            });
        }

        function animate() {
            requestAnimationFrame(animate);
            const elapsedTime = clock.getElapsedTime();

            if (isWelcomeSceneActive) {
                if (galaxy) galaxy.rotation.y += 0.0005;
                animateWelcomeObjects(welcomeObjects, elapsedTime);
                if (welcomeRenderer) welcomeRenderer.render(welcomeScene, welcomeCamera);
            } else {
                if(mainGalaxy) mainGalaxy.rotation.y += 0.0003;
                animateWelcomeObjects(mainWelcomeObjects, elapsedTime);

                if (mainObject && mainObject.scale.x < 1) {
                    const s = Math.min(mainObject.scale.x + 0.05, 1);
                    mainObject.scale.set(s, s, s);
                }
                animateIcons(socialIcons, mainCamera, elapsedTime);
                animateIcons(devIcons, mainCamera, elapsedTime);
                if (mainControls) mainControls.update();
                if (mainRenderer) mainRenderer.render(mainScene, mainCamera);
            }
        }

        initUI();
        initWelcomeScene();
        initMainScene();
        initIcons();
        animate();
    </script>
</body>
</html>

